name: Show `git diff`
on:
  workflow_dispatch:
jobs:
  check_for_changes:
    name: Check for changes
    runs-on: ubuntu-latest
    outputs:
      is_needed: ${{ steps.check_for_changes.outputs.result == 1 }}
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - name: Enable pipefail
        run: set -o pipefail
      - name: Check for changes
        id: check_for_changes
        run: |
          CHANGES_FILE=/tmp/changes_from_diff_from_to_diff_to
          git diff origin/diff_from...origin/diff_to_hoge | tee $CHANGES_FILE
          echo "result=$(test -s $CHANGES_FILE)" >> $GITHUB_OUTPUT

  some_operations:
    name: Some operations
    runs-on: ubuntu-latest
    needs: check_for_changes
    if: needs.check_for_changes.outputs.is_needed
    steps:
      - uses: actions/checkout@v4
      - name: echo
        run: echo backport
